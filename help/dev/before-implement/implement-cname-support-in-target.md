---
keywords: atendimento ao cliente, cname, programa de certificado, nome canÃ´nico, cookies, certificado, amc, certificado gerenciado pela adobe, digicert, validaÃ§Ã£o de controle de domÃ­nio, dcv, atendimento ao cliente2
description: Trabalhe com [!UICONTROL Adobe Client Care] para implementar o suporte CNAME (Canonical Name) em  [!DNL Adobe Target]  para lidar com problemas de bloqueio de anÃºncios.
title: Como usar CNAME no Target?
feature: Privacy & Security
exl-id: 5709df5b-6c21-4fea-b413-ca2e4912d6cb
source-git-commit: e5bae1ac9485c3e1d7c55e6386f332755196ffab
workflow-type: tm+mt
source-wordcount: '1164'
ht-degree: 1%

---

# CNAME e Target

InstruÃ§Ãµes para trabalhar com [!DNL Adobe Client Care] para implementar o suporte CNAME (Canonical Name) em [!DNL Adobe Target]. Use o CNAME para lidar com problemas de bloqueio de anÃºncios ou com polÃ­ticas de cookies relacionadas a ITP (Intelligent Tracking Prevention). Com o CNAME, as chamadas sÃ£o feitas para um domÃ­nio de propriedade do cliente, em vez de para um domÃ­nio de propriedade do Adobe.

## Solicitar suporte para CNAME no Target

1. Determine a lista de nomes de host necessÃ¡rios para seu certificado SSL (consulte as perguntas frequentes abaixo).

1. Para cada nome de host, crie um registro CNAME no DNS apontando para o nome de host [!DNL Target] comum `clientcode.tt.omtrdc.net`.

   Por exemplo, se o cÃ³digo de cliente for &quot;cnamcustomer&quot; e o nome de host proposto for `target.example.com`, o registro CNAME de DNS serÃ¡ semelhante a:

   ```
   target.example.com.  IN  CNAME  cnamecustomer.tt.omtrdc.net.
   ```

   >[!WARNING]
   >
   >A autoridade de certificaÃ§Ã£o Adobe, DigiCert, nÃ£o pode emitir um certificado atÃ© que essa etapa seja concluÃ­da. Portanto, o Adobe nÃ£o pode atender Ã  sua solicitaÃ§Ã£o para uma implementaÃ§Ã£o CNAME atÃ© que essa etapa seja concluÃ­da.

1. [Preencha este formulÃ¡rio](assets/FPC_Request_Form.xlsx) e inclua-o ao [abrir um tÃ­quete de Atendimento ao Cliente do Adobe solicitando suporte para CNAME](https://experienceleague.adobe.com/docs/target/using/cmp-resources-and-contact-information.html?#reference_ACA3391A00EF467B87930A450050077C):

   * CÃ³digo de cliente [!DNL Adobe Target]:
   * Nomes de host do certificado SSL (exemplo: `target.example.com target.example.org`):
   * Comprador de certificado SSL (o Adobe Ã© altamente recomendado, consulte Perguntas frequentes): Adobe/customer
   * Se o cliente estiver adquirindo o certificado, tambÃ©m conhecido como &quot;Traga seu prÃ³prio certificado&quot; (BYOC), preencha estes detalhes adicionais:
      * OrganizaÃ§Ã£o do certificado (exemplo: Example Company Inc):
      * Unidade organizacional do certificado (opcional, por exemplo: Marketing):
      * PaÃ­s do certificado (exemplo: EUA):
      * Estado/regiÃ£o do certificado (exemplo: CalifÃ³rnia):
      * Cidade do certificado (exemplo: San Jose):

1. Se o Adobe estiver comprando o certificado, o Adobe funcionarÃ¡ com a DigiCert para comprar e implantar seu certificado nos servidores de produÃ§Ã£o do Adobe.

   Se o cliente estiver comprando o certificado (BYOC), o Atendimento ao cliente do Adobe enviarÃ¡ a solicitaÃ§Ã£o de assinatura do certificado (CSR). Use a CSR ao adquirir o certificado por meio da autoridade de certificaÃ§Ã£o de sua escolha. Depois que o certificado for emitido, envie uma cÃ³pia do certificado e dos certificados intermediÃ¡rios para o Atendimento ao cliente do Adobe para implantaÃ§Ã£o.

   O Atendimento ao cliente do Adobe notifica quando a implementaÃ§Ã£o estÃ¡ pronta.

1. Atualize a `serverDomain` [documentaÃ§Ã£o](../implement/client-side/atjs/atjs-functions/targetglobalsettings.md#serverdomain) para o novo nome de host CNAME e defina `overrideMboxEdgeServer` como `false` [documentaÃ§Ã£o](../implement/client-side/atjs/atjs-functions/targetglobalsettings.md#overridemboxedgeserver) na sua configuraÃ§Ã£o at.js.

## Perguntas frequentes

As informaÃ§Ãµes a seguir respondem Ã s perguntas frequentes sobre a solicitaÃ§Ã£o e a implementaÃ§Ã£o do suporte CNAME no Target:

### Posso fornecer meu prÃ³prio certificado (Traga seu prÃ³prio certificado ou BYOC)?

VocÃª pode fornecer seu prÃ³prio certificado. No entanto, o Adobe nÃ£o recomenda essa prÃ¡tica. O gerenciamento do ciclo de vida do certificado SSL Ã© mais fÃ¡cil para o Adobe e para vocÃª, caso o Adobe compre e controle o certificado. Os certificados SSL devem ser renovados todos os anos. Portanto, o Atendimento ao cliente do Adobe deve entrar em contato com vocÃª todos os anos para obter um novo certificado em tempo hÃ¡bil. Alguns clientes podem ter dificuldade em produzir um certificado renovado em tempo hÃ¡bil. A implementaÃ§Ã£o do [!DNL Target] fica comprometida quando o certificado expira porque os navegadores recusam conexÃµes.

>[!WARNING]
>
>Se vocÃª solicitar uma implementaÃ§Ã£o CNAME [!DNL Target] com seu prÃ³prio certificado, serÃ¡ responsÃ¡vel por fornecer certificados renovados ao Atendimento ao cliente do Adobe todos os anos. Permitir que seu certificado CNAME expire antes que o Adobe possa implantar um certificado renovado resulta em uma interrupÃ§Ã£o para sua implementaÃ§Ã£o especÃ­fica do [!DNL Target].

### Quanto tempo atÃ© meu novo certificado SSL expirar?

Todos os certificados adquiridos pela Adobe sÃ£o vÃ¡lidos por um ano. Consulte o artigo da [DigiCert sobre certificados de 1 ano](https://www.digicert.com/blog/position-on-1-year-certificates) para obter mais informaÃ§Ãµes.

### Quais nomes de host devo escolher? Quantos nomes de host por domÃ­nio devo escolher?

As implementaÃ§Ãµes de CNAME do Target exigem apenas um nome de host por domÃ­nio no certificado SSL e no DNS do cliente. O Adobe recomenda um nome de host por domÃ­nio. Alguns clientes exigem mais nomes de host por domÃ­nio para suas prÃ³prias finalidades (teste em preparo, por exemplo), que sÃ£o compatÃ­veis.

A maioria dos clientes escolhe um nome de host como `target.example.com`. A Adobe recomenda seguir essa prÃ¡tica, mas a escolha Ã© sua. NÃ£o solicitar um nome de host de um registro DNS existente. Isso causa um conflito e atrasa a resoluÃ§Ã£o da solicitaÃ§Ã£o CNAME [!DNL Target].

### JÃ¡ tenho uma implementaÃ§Ã£o CNAME para o Adobe Analytics. Posso usar o mesmo certificado ou nome de host?

NÃ£o, [!DNL Target] requer um nome de host e um certificado separados.

### Minha implementaÃ§Ã£o atual do [!DNL Target] Ã© afetada pela ITP 2.x?

A Apple Intelligent Tracking Prevention (ITP) versÃ£o 2.3 apresentou o recurso de MitigaÃ§Ã£o de Camuflagem CNAME, que pode detectar [!DNL Target] implementaÃ§Ãµes CNAME e reduz a expiraÃ§Ã£o do cookie para sete dias. No momento, [!DNL Target] nÃ£o tem uma soluÃ§Ã£o alternativa para a MitigaÃ§Ã£o de Camuflagem CNAME da ITP. Para obter mais informaÃ§Ãµes sobre a ITP, consulte [Apple Intelligent Tracking Prevention (ITP) 2.x](../before-implement/privacy/apple-itp-2x.md).

### Que tipo de interrupÃ§Ã£o de serviÃ§o posso esperar quando minha implementaÃ§Ã£o CNAME Ã© implantada?

NÃ£o hÃ¡ interrupÃ§Ã£o do serviÃ§o quando o certificado Ã© implantado (incluindo renovaÃ§Ãµes de certificado).

No entanto, depois de alterar o nome do host no cÃ³digo de implementaÃ§Ã£o [!DNL Target] (`serverDomain` na at.js) para o novo nome de host CNAME (`target.example.com`), os navegadores da Web tratam os visitantes recorrentes como novos visitantes. Os dados de perfil dos visitantes retornados sÃ£o perdidos porque o cookie anterior estÃ¡ inacessÃ­vel sob o nome de host antigo (`clientcode.tt.omtrdc.net`). O cookie anterior estÃ¡ inacessÃ­vel devido aos modelos de seguranÃ§a do navegador. Essa interrupÃ§Ã£o ocorre somente na transiÃ§Ã£o inicial para o novo CNAME. As renovaÃ§Ãµes de certificado nÃ£o tÃªm o mesmo efeito, pois o nome do host nÃ£o Ã© alterado.

### Qual tipo de chave e algoritmo de assinatura de certificado Ã© usado para minha implementaÃ§Ã£o CNAME?

Todos os certificados sÃ£o RSA SHA-256 e as chaves sÃ£o RSA 2048-bit, por padrÃ£o. Atualmente, nÃ£o hÃ¡ suporte para tamanhos de chave maiores que 2048 bits.

### Como posso validar se minha implementaÃ§Ã£o CNAME estÃ¡ pronta para o trÃ¡fego?

Use o seguinte conjunto de comandos (no terminal de linha de comando macOS ou Linux, usando bash e curl >=7.49):

1. Copie e cole esta funÃ§Ã£o bash no terminal ou cole a funÃ§Ã£o no arquivo de script de inicializaÃ§Ã£o bash (geralmente `~/.bash_profile` ou `~/.bashrc`) para que a funÃ§Ã£o esteja disponÃ­vel nas sessÃµes de terminal:

   ```
   function adobeTargetCnameValidation {
     local hostname="$1"
     if [ -z "$hostname" ]; then
       echo "ERROR: no hostname specified"
       return 1
     fi
   
     local service="Adobe Target CNAME implementation"
     local edges="31 32 34 35 36 37 38"
     local edgeDomain="tt.omtrdc.net"
     local edgeFormat="mboxedge%d%s.$edgeDomain"
     local shardFormat="-alb%02d"
     local shards=5
     local shardsFoundCount=0
     local shardsFound
     local shardsFoundOutput
     local curlRegex="subject:.*CN=|expire date:|issuer:"
     local curlValidation="SSL certificate verify ok"
     local curlResponseValidation='"OK"'
     local curlEndpoint="/uptime?mboxClient=uptime3"
     local url="https://$hostname$curlEndpoint"
     local sslLabsUrl="https://ssllabs.com/ssltest/analyze.html?hideResults=on&latest&d=$hostname"
     local success="âœ…"
     local failure="ðŸš«"
     local info="ðŸ”Ž"
     local rule="="
     local horizontalRule="$(seq ${COLUMNS:-30} | xargs printf "$rule%.0s")"
     local miniRule="$(seq 5 | xargs printf "$rule%.0s")"
     local curlVersion="$(curl --version | head -1 | cut -d' ' -f2 )"
     local curlVersionRequired=">=7.49"
     local edgeCount="$(wc -w <<< "$edges" | tr -d ' ')"
     local edge
     local shard
     local currEdgeShard
     local dnsOutput
     local cnameExists
     local endToEndTestSucceeded
     local curlResult
   
     for shard in $(seq $shards); do
       if [ "$shardsFoundCount" -eq 0 ]; then
         for edge in $edges; do
           if [ "$shard" -eq 1 ]; then
             currEdgeShard="$(printf "$edgeFormat" "$edge" "")"
           else
             currEdgeShard="$(
               printf "$edgeFormat" "$edge" "$(
                 printf -- "$shardFormat" "$shard"
               )"
             )"
           fi
           curlResult="$(curl -vsm20 --connect-to "$hostname:443:$currEdgeShard:443" "$url" 2>&1)"
           if grep -q "$curlValidation" <<< "$curlResult"; then
             shardsFound+=" $currEdgeShard"
             if grep -q "$curlResponseValidation" <<< "$curlResult"; then
               shardsFoundCount=$((shardsFoundCount+1))
               shardsFoundOutput+="\n\n$miniRule $success $hostname [edge shard: $currEdgeShard] $miniRule\n"
             else
               shardsFoundOutput+="\n\n$miniRule $failure $hostname [edge shard: $currEdgeShard] $miniRule\n"
             fi
             shardsFoundOutput+="$(grep -E "$curlRegex" <<< "$curlResult" | sort)"
             if ! grep -q "$curlResponseValidation" <<< "$curlResult"; then
               shardsFoundOutput+="\nERROR: unexpected HTTP response from this shard using $url"
             fi
           fi
         done
       fi
     done
   
     echo
     echo "$horizontalRule"
     echo
     echo "$service validation for hostname $hostname:"
     dnsOutput="$(dig -t CNAME +short "$hostname" 2>&1)"
     if grep -qFi ".$edgeDomain" <<< "$dnsOutput"; then
       echo "$success $hostname passes DNS CNAME validation"
       cnameExists=true
     else
       echo -n "$failure $hostname FAILED DNS CNAME validation -- "
       if [ -n "$dnsOutput" ]; then
         echo -e "$dnsOutput is not in the subdomain $edgeDomain"
       else
         echo "required DNS CNAME record pointing to <target-client-code>.$edgeDomain not found"
       fi
     fi
   
     curlResult="$(curl -vsm20 "$url" 2>&1)"
     if grep -q "$curlValidation" <<< "$curlResult"; then
       if grep -q "$curlResponseValidation" <<< "$curlResult"; then
         echo -en "$success $hostname passes TLS and HTTP response validation"
         if [ -n "$cnameExists" ]; then
           echo
         else
           echo " -- the DNS CNAME is not pointing to the correct subdomain for ${service}s with Adobe-managed certificates" \
             "(bring-your-own-certificate implementations don't have this requirement), but this test passes as configured"
         fi
         endToEndTestSucceeded=true
       else
         echo -n "$failure $hostname FAILED HTTP response validation --" \
           "unexpected response from $url -- "
         if [ -n "$cnameExists" ]; then
           echo "DNS is NOT pointing to the correct shard, notify Adobe Client Care"
         else
           echo "the required DNS CNAME record is missing, see above"
         fi
       fi
     else
   
       echo -n "$failure $hostname FAILED TLS validation -- "
       if [ -n "$cnameExists" ]; then
         echo "DNS is likely NOT pointing to the correct shard or there's a validation issue with the certificate or" \
           "protocols, see curl output below and optionally SSL Labs ($sslLabsUrl):"
         echo ""
         echo "$horizontalRule"
         echo "$curlResult" | sed 's/^/    /g'
         echo "$horizontalRule"
         echo ""
       else
         echo "the required DNS CNAME record is missing, see above"
       fi
     fi
   
     if [ "$shardsFoundCount" -ge "$edgeCount" ]; then
       echo -n "$success $hostname passes shard validation for the following $shardsFoundCount edge shards:"
       echo -e "$shardsFoundOutput"
       echo
   
       if [ -n "$cnameExists" ] && [ -n "$endToEndTestSucceeded" ]; then
         echo "$horizontalRule"
         echo ""
         echo "  For additional TLS/SSL validation, including detailed browser/client support,"
         echo "  see SSL Labs (click the first IP address if prompted):"
         echo ""
         echo "    $info  $sslLabsUrl"
         echo ""
         echo "  To check DNS propagation around the world, see whatsmydns.net:"
         echo ""
         echo "    $info  DNS A records:     https://whatsmydns.net/#A/$hostname"
         echo "    $info  DNS CNAME record:  https://whatsmydns.net/#CNAME/$hostname"
       fi
     else
       echo -n "$failure $hostname FAILED shard validation -- shards found: $shardsFoundCount," \
         "expected: $edgeCount"
       if bc -l <<< "$(cut -d. -f1,2 <<< "$curlVersion") $curlVersionRequired" 2>/dev/null | grep -q 0; then
         echo -n " -- insufficient curl version installed: $curlVersion, but this script requires curl version" \
           "$curlVersionRequired because it uses the curl --connect-to flag to bypass DNS and directly test" \
           "each Adobe Target edge shards' SNI confirguation for $hostname"
       fi
       if [ -n "$shardsFoundOutput" ]; then
         echo -e ":\n$shardsFoundOutput"
       fi
       echo
     fi
     echo
     echo "$horizontalRule"
     echo
   }
   ```

1. Cole este comando (substituindo `target.example.com` pelo seu nome de host):

   ```
   adobeTargetCnameValidation target.example.com
   ```

   Se a implementaÃ§Ã£o estiver pronta, vocÃª verÃ¡ a saÃ­da como abaixo. A parte importante Ã© que todas as linhas de status de validaÃ§Ã£o mostram `âœ…` em vez de `ðŸš«`. Cada fragmento CNAME da borda do Target deve mostrar `CN=target.example.com`, que corresponde ao nome de host principal no certificado solicitado (nomes de host SAN adicionais no certificado nÃ£o sÃ£o impressos nesta saÃ­da).

   ```
   $ adobeTargetCnameValidation target.example.com
   
   ==========================================================
   
   Adobe Target CNAME implementation validation for hostname target.example.com:
   âœ… target.example.com passes DNS CNAME validation
   âœ… target.example.com passes TLS and HTTP response validation
   âœ… target.example.com passes shard validation for the following 7 edge shards:
   
   ===== âœ… target.example.com [edge shard: mboxedge31-alb02.tt.omtrdc.net] =====
   *  expire date: Jul 22 23:59:59 2022 GMT
   *  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1
   *  subject: C=US; ST=California; L=San Jose; O=Adobe Systems Incorporated; CN=target.example.com
   
   ===== âœ… target.example.com [edge shard: mboxedge32-alb02.tt.omtrdc.net] =====
   *  expire date: Jul 22 23:59:59 2022 GMT
   *  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1
   *  subject: C=US; ST=California; L=San Jose; O=Adobe Systems Incorporated; CN=target.example.com
   
   ===== âœ… target.example.com [edge shard: mboxedge34-alb02.tt.omtrdc.net] =====
   *  expire date: Jul 22 23:59:59 2022 GMT
   *  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1
   *  subject: C=US; ST=California; L=San Jose; O=Adobe Systems Incorporated; CN=target.example.com
   
   ===== âœ… target.example.com [edge shard: mboxedge35-alb02.tt.omtrdc.net] =====
   *  expire date: Jul 22 23:59:59 2022 GMT
   *  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1
   *  subject: C=US; ST=California; L=San Jose; O=Adobe Systems Incorporated; CN=target.example.com
   
   ===== âœ… target.example.com [edge shard: mboxedge36-alb02.tt.omtrdc.net] =====
   *  expire date: Jul 22 23:59:59 2022 GMT
   *  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1
   *  subject: C=US; ST=California; L=San Jose; O=Adobe Systems Incorporated; CN=target.example.com
   
   ===== âœ… target.example.com [edge shard: mboxedge37-alb02.tt.omtrdc.net] =====
   *  expire date: Jul 22 23:59:59 2022 GMT
   *  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1
   *  subject: C=US; ST=California; L=San Jose; O=Adobe Systems Incorporated; CN=target.example.com
   
   ===== âœ… target.example.com [edge shard: mboxedge38-alb02.tt.omtrdc.net] =====
   *  expire date: Jul 22 23:59:59 2022 GMT
   *  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1
   *  subject: C=US; ST=California; L=San Jose; O=Adobe Systems Incorporated; CN=target.example.com
   
   ==========================================================
   
     For additional TLS/SSL validation, including detailed browser/client support,
     see SSL Labs (click the first IP address if prompted):
   
       ðŸ”Ž  https://ssllabs.com/ssltest/analyze.html?hideResults=on&latest&d=target.example.com
   
     To check DNS propagation around the world, see whatsmydns.net:
   
       ðŸ”Ž  DNS A records:     https://whatsmydns.net/#A/target.example.com
       ðŸ”Ž  DNS CNAME record:  https://whatsmydns.net/#CNAME/target.example.com
   
   ==========================================================
   ```

>[!NOTE]
>
>Se esse comando de validaÃ§Ã£o falhar na validaÃ§Ã£o de DNS, mas vocÃª jÃ¡ tiver feito as alteraÃ§Ãµes necessÃ¡rias no DNS, talvez seja necessÃ¡rio aguardar a propagaÃ§Ã£o completa das atualizaÃ§Ãµes de DNS. Os registros DNS tÃªm um [TTL (time-to-live)](https://en.wikipedia.org/wiki/Time_to_live#DNS_records) associado que determina o tempo de expiraÃ§Ã£o do cache para as respostas DNS desses registros. Como resultado, talvez seja necessÃ¡rio aguardar pelo menos tanto tempo quanto seus TTLs. VocÃª pode usar o comando `dig target.example.com` ou [a Caixa de Ferramentas do G Suite](https://toolbox.googleapps.com/apps/dig/#CNAME) para pesquisar seus TTLs especÃ­ficos. Para verificar a propagaÃ§Ã£o DNS pelo mundo, consulte [whatsmydns.net](https://whatsmydns.net/#CNAME).

### Como usar um link para opÃ§Ã£o de nÃ£o participaÃ§Ã£o com CNAME

Se vocÃª estiver usando CNAME, o link para opÃ§Ã£o de nÃ£o participaÃ§Ã£o deverÃ¡ conter o parÃ¢metro &quot;client=`clientcode`&quot;, por exemplo:
`https://my.cname.domain/optout?client=clientcode`.

Substitua `clientcode` com seu cÃ³digo de cliente e adicione o texto ou imagem a ser vinculado Ã  [URL de nÃ£o participaÃ§Ã£o](privacy/privacy.md).

## LimitaÃ§Ãµes conhecidas

* O modo de controle de qualidade nÃ£o Ã© aderente quando vocÃª tem CNAME e at.js 1.x porque ele se baseia em um cookie de terceiros. A soluÃ§Ã£o alternativa Ã© adicionar os parÃ¢metros de prÃ©-visualizaÃ§Ã£o a cada URL para o qual vocÃª navega. O modo de controle de qualidade Ã© aderente quando vocÃª tem CNAME e at.js 2.x.
* Ao usar CNAME, fica mais provÃ¡vel que o tamanho do cabeÃ§alho do cookie para chamadas [!DNL Target] aumente. A Adobe recomenda manter o tamanho do cookie abaixo de 8 KB.
